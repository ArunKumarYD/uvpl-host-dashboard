<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>UVPL Live Score</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: #1E293B; /* navy bg */
      color: white;
      min-height: 100vh;
      padding: 1rem;
    }
    .container {
      max-width: 900px;
      margin: auto;
      background: #2D3748; /* dark card bg */
      border-radius: 12px;
      padding: 1.5rem;
      position: relative;
    }
    .company-logo {
      max-height: 60px;
      position: absolute;
      top: 15px;
      left: 15px;
    }
    .team-logo {
      max-height: 45px;
      margin-left: 12px;
    }
    .score-btn {
      background: #3B82F6;
      border: none;
      border-radius: 4px;
      padding: 0 10px;
      font-weight: bold;
      cursor: pointer;
      user-select: none;
      transition: background-color 0.2s ease-in-out;
    }
    .score-btn:hover {
      background: #2563EB;
    }
    input[type="number"] {
      width: 48px;
      text-align: center;
      background: #1E293B;
      color: white;
      border: 1px solid #4B5563;
      border-radius: 4px;
      font-size: 1rem;
    }
    .player-list {
      max-height: 140px;
      overflow-y: auto;
      margin-top: 0.25rem;
      background: #374151;
      border-radius: 6px;
      padding: 0.5rem;
    }
    .player-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 4px;
      font-size: 0.9rem;
    }
    .player-name {
      flex-grow: 1;
    }
    .add-player-btn {
      margin-top: 0.5rem;
      background: #10B981;
      color: white;
      border: none;
      padding: 0.25rem 0.75rem;
      border-radius: 5px;
      cursor: pointer;
      font-weight: 600;
    }
    .add-player-btn:hover {
      background: #059669;
    }
    .header-row th {
      border-bottom: 2px solid #2563EB;
      padding-bottom: 6px;
      font-weight: 700;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 1rem;
    }
    td, th {
      text-align: center;
      padding: 0.5rem;
      border: 1px solid #4B5563;
    }
    .vs-text {
      font-weight: 700;
      font-size: 1.3rem;
      padding: 0 12px;
      user-select: none;
    }
    .match-info {
      text-align: center;
      margin-bottom: 1rem;
      font-weight: 600;
      font-size: 1.1rem;
      color: #93C5FD;
    }
    .winner-btn {
      background: #2563EB;
      padding: 0.7rem 2rem;
      font-weight: 700;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      color: white;
      display: block;
      margin: 0 auto;
      margin-top: 1rem;
      user-select: none;
    }
    .winner-btn:hover {
      background: #1E40AF;
    }
  </style>
</head>
<body>
  <div class="container" id="scoreCard">
    <img src="assets/logos/company-logo.png" alt="Company Logo" class="company-logo" />

    <h1 class="text-center text-3xl font-bold mb-4">UVPL Live Score Sheet</h1>
    <div class="match-info" id="matchInfo">Loading match info...</div>

    <div class="flex justify-between items-center mb-4">
      <div class="flex items-center" id="team1Container">
        <span id="team1Name" class="text-xl font-semibold"></span>
        <img id="team1Logo" src="" alt="Team 1 Logo" class="team-logo" />
      </div>
      <div class="vs-text">VS</div>
      <div class="flex items-center" id="team2Container">
        <span id="team2Name" class="text-xl font-semibold"></span>
        <img id="team2Logo" src="" alt="Team 2 Logo" class="team-logo" />
      </div>
    </div>

    <table>
      <thead>
        <tr class="header-row">
          <th>Set</th>
          <th id="team1Header">Team 1</th>
          <th id="team2Header">Team 2</th>
        </tr>
      </thead>
      <tbody id="setsTableBody">
        <!-- Sets rows will be generated here -->
      </tbody>
      <tfoot>
        <tr>
          <th>Total</th>
          <th id="team1TotalScore">0</th>
          <th id="team2TotalScore">0</th>
        </tr>
      </tfoot>
    </table>

    <div class="flex justify-between">
      <div style="width:48%">
        <h3 class="font-semibold mb-1">Team 1 Players</h3>
        <div class="player-list" id="team1PlayersList"></div>
        <input type="text" id="team1NewPlayer" placeholder="Add player name" class="w-full p-1 rounded text-black" />
        <button class="add-player-btn" onclick="addPlayer('team1')">Add Player</button>
      </div>
      <div style="width:48%">
        <h3 class="font-semibold mb-1">Team 2 Players</h3>
        <div class="player-list" id="team2PlayersList"></div>
        <input type="text" id="team2NewPlayer" placeholder="Add player name" class="w-full p-1 rounded text-black" />
        <button class="add-player-btn" onclick="addPlayer('team2')">Add Player</button>
      </div>
    </div>

    <button class="winner-btn" onclick="generateReport()">Declare Winner & Download Report</button>
  </div>

<script>
  // Globals
  const totalSets = 3;
  let team1Scores = Array(totalSets).fill(0);
  let team2Scores = Array(totalSets).fill(0);
  let team1Players = [];
  let team2Players = [];

  function getLogoURL(teamName) {
    return `assets/logos/${teamName.toLowerCase().replace(/\s+/g, "-")}.png`;
  }

  function updateMatchInfo() {
    const urlParams = new URLSearchParams(window.location.search);
    const team1 = urlParams.get("team1") || "Team 1";
    const team2 = urlParams.get("team2") || "Team 2";
    const date = urlParams.get("date") || "Date";
    const time = urlParams.get("time") || "Time";

    document.getElementById("team1Name").innerText = team1;
    document.getElementById("team2Name").innerText = team2;
    document.getElementById("team1Header").innerText = team1;
    document.getElementById("team2Header").innerText = team2;

    document.getElementById("team1Logo").src = getLogoURL(team1);
    document.getElementById("team2Logo").src = getLogoURL(team2);

    document.getElementById("matchInfo").innerText = `Match Date: ${date}, Time: ${time}`;
  }

  function createSetsTable() {
    const tbody = document.getElementById("setsTableBody");
    tbody.innerHTML = "";

    for(let i=0; i<totalSets; i++) {
      const tr = document.createElement("tr");

      const setTd = document.createElement("td");
      setTd.innerText = i + 1;
      tr.appendChild(setTd);

      // Team 1 score cell with +/- buttons and score display input
      const team1Td = document.createElement("td");
      const team1DecBtn = document.createElement("button");
      team1DecBtn.className = "score-btn";
      team1DecBtn.innerText = "–";
      team1DecBtn.onclick = () => updateScore('team1', i, -1);
      const team1ScoreInput = document.createElement("input");
      team1ScoreInput.type = "number";
      team1ScoreInput.min = 0;
      team1ScoreInput.value = team1Scores[i];
      team1ScoreInput.oninput = (e) => updateScoreManual('team1', i, e.target.value);
      const team1IncBtn = document.createElement("button");
      team1IncBtn.className = "score-btn";
      team1IncBtn.innerText = "+";
      team1IncBtn.onclick = () => updateScore('team1', i, 1);

      team1Td.appendChild(team1DecBtn);
      team1Td.appendChild(team1ScoreInput);
      team1Td.appendChild(team1IncBtn);
      tr.appendChild(team1Td);

      // Team 2 score cell with +/- buttons and score display input
      const team2Td = document.createElement("td");
      const team2DecBtn = document.createElement("button");
      team2DecBtn.className = "score-btn";
      team2DecBtn.innerText = "–";
      team2DecBtn.onclick = () => updateScore('team2', i, -1);
      const team2ScoreInput = document.createElement("input");
      team2ScoreInput.type = "number";
      team2ScoreInput.min = 0;
      team2ScoreInput.value = team2Scores[i];
      team2ScoreInput.oninput = (e) =>
