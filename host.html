<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Host Dashboard – UVPL</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body { font-family: Arial, sans-serif; padding: 2rem; }
    h1 { background-color: #2e1065; color: white; padding: 1rem; border-radius: 8px; text-align: center; }
    button, select, input { margin: 0.5rem 0; padding: 0.5rem; font-size: 1rem; }
    .section { margin-top: 2rem; border-top: 2px solid #ddd; padding-top: 1.5rem; }
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    th, td { border: 1px solid #ccc; padding: 0.5rem; text-align: center; }
    th { background-color: #2e1065; color: white; }
    .player-name:hover, .team-name:hover { cursor: pointer; color: green; font-weight: bold; }
    .live-box { background: #f5f5f5; padding: 1rem; margin-top: 1rem; border-radius: 8px; }
  </style>
</head>
<body>
  <h1>🏐 Host Dashboard – UVPL</h1>
  <button onclick="window.open('players.html')">🏅 View Top Players</button>

  <div id="matchScheduler" class="section">
    <h2>📅 Match Scheduler</h2>
    <label>Gender: <select id="schedGender" onchange="populateSchedulerTeams()"><option>Men</option><option>Women</option></select></label><br/>
    <label>Team 1: <select id="schedTeam1"></select></label>
    <label>Team 2: <select id="schedTeam2"></select></label><br/>
    <label>Date: <input type="date" id="matchDate"></label>
    <label>Time:
      <select id="matchTime">
        <option>18:00</option><option>18:45</option><option>19:30</option><option>20:15</option>
      </select>
    </label><br/>
    <button onclick="scheduleMatch()">📅 Save Match</button>
    <button onclick="startMatch()">🚀 Start Match</button>
    <div id="liveControls" style="display:none;" class="live-box">
      <h3>🎯 Live Match Controls</h3>
      <div id="liveTeams"></div>
      <div id="livePlayers"></div>
      <label>Declare Winner: <select id="winnerSelect"></select></label><br/>
      <button onclick="endMatch()">🏁 End Match & Update Points</button>
    </div>
  </div>

  <div id="playerManager" class="section">
    <h2>👥 Player Manager</h2>
    <label>Gender: <select id="pmGenderSelect" onchange="populatePlayerTeams()"><option value="Men">Men</option><option value="Women">Women</option></select></label>
    <label>Team: <select id="pmTeamSelect"></select></label>
    <button onclick="loadPlayers()">Load Players</button>
    <table id="playersTable">
      <thead><tr><th>Name</th><th>Matches</th><th>Points</th><th>Role</th><th>Action</th></tr></thead>
      <tbody></tbody>
    </table>
    <button onclick="addPlayerRow()">+ Add Player</button>
    <button onclick="savePlayers()">💾 Save All</button>
  </div>

  <div id="rulesEditor" class="section">
    <h2>📘 Rules Editor</h2>
    <textarea id="rulesText" rows="8" style="width:100%;"></textarea><br/>
    <button onclick="saveRules()">💾 Save Rules</button>
  </div>

  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-database-compat.js"></script>
  <script src="firebase-config.js"></script>
  <script>
    const db = firebase.database();
    const allTeams = {
      Men: ["United Challengers", "UC Twistter", "Azraq Astronuts", "IJC Ninjas"],
      Women: ["United Challengers", "UC Twistter", "Azraq Astronuts", "IJC Ninjas"]
    };

    function populateSchedulerTeams() {
      const gender = document.getElementById("schedGender").value;
      const team1 = document.getElementById("schedTeam1");
      const team2 = document.getElementById("schedTeam2");
      team1.innerHTML = "";
      team2.innerHTML = "";
      allTeams[gender].forEach(t => {
        team1.innerHTML += `<option value="${t}">${t}</option>`;
        team2.innerHTML += `<option value="${t}">${t}</option>`;
      });
    }

    function populatePlayerTeams() {
      const gender = document.getElementById("pmGenderSelect").value;
      const select = document.getElementById("pmTeamSelect");
      select.innerHTML = "";
      allTeams[gender].forEach(team => {
        select.innerHTML += `<option value="${team}">${team}</option>`;
      });
    }

    window.onload = () => {
      populateSchedulerTeams();
      populatePlayerTeams();
    };
  </script>
</body>
</html>
